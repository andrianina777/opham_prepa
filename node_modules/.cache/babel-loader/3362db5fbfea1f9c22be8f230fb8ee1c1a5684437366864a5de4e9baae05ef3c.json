{"ast":null,"code":"import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, withCtx as _withCtx, createBlock as _createBlock, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-1125d5b6\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"pa-2\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"thead\", null, [/*#__PURE__*/_createElementVNode(\"tr\", null, [/*#__PURE__*/_createElementVNode(\"th\", {\n  class: \"text-center\"\n}, \" Rayon \"), /*#__PURE__*/_createElementVNode(\"th\", {\n  class: \"text-center\"\n}, \" Nb Article \"), /*#__PURE__*/_createElementVNode(\"th\", {\n  class: \"text-center\"\n}, [/*#__PURE__*/_createCommentVNode(\" <v-checkbox v-model=\\\"selectAll\\\" color=\\\"primary\\\" hide-details></v-checkbox> \")])])], -1 /* HOISTED */));\nconst _hoisted_3 = {\n  key: 0,\n  class: \"pa-10\"\n};\nconst _hoisted_4 = {\n  class: \"pa-2\"\n};\nconst _hoisted_5 = {\n  key: 0\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_v_icon = _resolveComponent(\"v-icon\");\n  const _component_v_list_item_title = _resolveComponent(\"v-list-item-title\");\n  const _component_v_list_item_subtitle = _resolveComponent(\"v-list-item-subtitle\");\n  const _component_v_list_item = _resolveComponent(\"v-list-item\");\n  const _component_v_list = _resolveComponent(\"v-list\");\n  const _component_v_col = _resolveComponent(\"v-col\");\n  const _component_v_checkbox = _resolveComponent(\"v-checkbox\");\n  const _component_v_table = _resolveComponent(\"v-table\");\n  const _component_v_btn = _resolveComponent(\"v-btn\");\n  const _component_v_alert = _resolveComponent(\"v-alert\");\n  const _component_ConfirmationDialog = _resolveComponent(\"ConfirmationDialog\");\n  const _component_MyLoading = _resolveComponent(\"MyLoading\");\n  const _component_router_view = _resolveComponent(\"router-view\");\n  const _component_v_row = _resolveComponent(\"v-row\");\n  const _component_v_progress_linear = _resolveComponent(\"v-progress-linear\");\n  const _component_MyTable = _resolveComponent(\"MyTable\");\n  const _component_v_sheet = _resolveComponent(\"v-sheet\");\n  const _component_v_card = _resolveComponent(\"v-card\");\n  const _component_v_container = _resolveComponent(\"v-container\");\n  const _component_MyDialog = _resolveComponent(\"MyDialog\");\n  return _openBlock(), _createBlock(_component_MyDialog, {\n    titre_toolbar: _ctx.titre_detail,\n    onClose: _ctx.closeDialog,\n    modelValue: _ctx.dialogVisible,\n    \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => _ctx.dialogVisible = $event)\n  }, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [!_ctx.loading ? (_openBlock(), _createBlock(_component_v_row, {\n      key: 0\n    }, {\n      default: _withCtx(() => [_createVNode(_component_v_col, {\n        cols: \"10\",\n        md: \"2\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_v_list, {\n          lines: false,\n          density: \"compact\",\n          nav: \"\"\n        }, {\n          default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.storePrep.depotCmd, (item, i) => {\n            return _openBlock(), _createBlock(_component_v_list_item, {\n              key: i,\n              value: item,\n              \"active-color\": \"primary\",\n              onClick: $event => _ctx.selectItem(item)\n            }, {\n              prepend: _withCtx(() => [_createVNode(_component_v_icon, {\n                icon: \"mdi-star\"\n              })]),\n              default: _withCtx(() => [_createVNode(_component_v_list_item_title, {\n                textContent: _toDisplayString(item.depot)\n              }, null, 8 /* PROPS */, [\"textContent\"]), _createVNode(_component_v_list_item_subtitle, {\n                textContent: _toDisplayString('Nb Article: ' + item.nb_article)\n              }, null, 8 /* PROPS */, [\"textContent\"])]),\n              _: 2 /* DYNAMIC */\n            }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"value\", \"onClick\"]);\n          }), 128 /* KEYED_FRAGMENT */))]),\n\n          _: 1 /* STABLE */\n        })]),\n\n        _: 1 /* STABLE */\n      }), _createVNode(_component_v_col, {\n        cols: \"10\",\n        md: \"2\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_v_table, {\n          \"fixed-header\": \"\",\n          height: \"300px\",\n          density: \"compact\"\n        }, {\n          default: _withCtx(() => [_hoisted_2, _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.filteredRayonCmd, item => {\n            return _openBlock(), _createElementBlock(\"tr\", {\n              key: item.rayon\n            }, [_createElementVNode(\"td\", null, _toDisplayString(item.rayon), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(item.nb_article), 1 /* TEXT */), _createElementVNode(\"td\", null, [_createVNode(_component_v_checkbox, {\n              modelValue: item.etat,\n              \"onUpdate:modelValue\": $event => item.etat = $event,\n              checked: item.etat,\n              \"hide-details\": \"\",\n              color: \"primary\",\n              onChange: $event => _ctx.handleCheckboxChange(item)\n            }, null, 8 /* PROPS */, [\"modelValue\", \"onUpdate:modelValue\", \"checked\", \"onChange\"])])]);\n          }), 128 /* KEYED_FRAGMENT */))])]),\n\n          _: 1 /* STABLE */\n        })]),\n\n        _: 1 /* STABLE */\n      }), _createVNode(_component_v_col, {\n        cols: \"10\",\n        md: \"4\"\n      }), _createVNode(_component_v_col, {\n        cols: \"10\",\n        md: \"2\",\n        class: \"text-center\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_v_btn, {\n          block: \"\",\n          rounded: \"xs\",\n          variant: \"elevated\",\n          color: \"#D3D3D3\",\n          onClick: _ctx.onPrepareClick\n        }, {\n          default: _withCtx(() => [_createTextVNode(\"PREPARER\")]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"onClick\"]), _ctx.selectedDepotCmd ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createTextVNode(\" PREPARATION --> \"), _createElementVNode(\"b\", null, _toDisplayString(_ctx.selectedDepotCmd.depot), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true), _ctx.isError ? (_openBlock(), _createBlock(_component_v_alert, {\n          key: 1,\n          type: \"error\",\n          onClick: _cache[0] || (_cache[0] = $event => (_ctx.isError = false, _ctx.dialog = false))\n        }, {\n          default: _withCtx(() => [_createTextVNode(\"preparation GROS en premier\")]),\n          _: 1 /* STABLE */\n        })) : _createCommentVNode(\"v-if\", true), _ctx.isVide && !_ctx.isError ? (_openBlock(), _createBlock(_component_v_alert, {\n          key: 2,\n          type: \"error\",\n          onClick: _cache[1] || (_cache[1] = $event => (_ctx.isVide = false, _ctx.dialog = false))\n        }, {\n          default: _withCtx(() => [_createTextVNode(\"La liste des articles à preparer est vide\")]),\n          _: 1 /* STABLE */\n        })) : _createCommentVNode(\"v-if\", true), _ctx.isVideL6 && !_ctx.isVide && !_ctx.isError ? (_openBlock(), _createBlock(_component_v_alert, {\n          key: 3,\n          type: \"error\",\n          onClick: _cache[2] || (_cache[2] = $event => (_ctx.isVideL6 = false, _ctx.dialog = false))\n        }, {\n          default: _withCtx(() => [_createTextVNode(\"Un probleme est survenu sur la sortie de Bon de preparation, Veuillez contacter le responsable\")]),\n          _: 1 /* STABLE */\n        })) : _createCommentVNode(\"v-if\", true), _ctx.dialog && !_ctx.isVideL6 && !_ctx.isVide && !_ctx.isError ? (_openBlock(), _createBlock(_component_ConfirmationDialog, {\n          key: 4,\n          modelValue: _ctx.dialog,\n          \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => _ctx.dialog = $event),\n          title: \"Confirmation de Préparation\",\n          message: _ctx.message,\n          onHandleYes: _ctx.handleYes,\n          onHandleNo: _ctx.handleNo\n        }, null, 8 /* PROPS */, [\"modelValue\", \"message\", \"onHandleYes\", \"onHandleNo\"])) : _createCommentVNode(\"v-if\", true), _createVNode(_component_MyLoading, {\n          loading: _ctx.chagmt,\n          onClose: _cache[4] || (_cache[4] = $event => _ctx.chagmt = false),\n          articles: _ctx.articles\n        }, null, 8 /* PROPS */, [\"loading\", \"articles\"]), _createVNode(_component_router_view)]),\n        _: 1 /* STABLE */\n      })]),\n\n      _: 1 /* STABLE */\n    })) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_4, [_ctx.loading ? (_openBlock(), _createBlock(_component_v_progress_linear, {\n      key: 0,\n      color: \"primary\",\n      rounded: \"\",\n      indeterminate: \"\",\n      height: \"5\"\n    })) : _createCommentVNode(\"v-if\", true)]), _ctx.updated ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_createVNode(_component_v_container, {\n      fluid: \"\"\n    }, {\n      default: _withCtx(() => [!_ctx.loading ? (_openBlock(), _createBlock(_component_MyTable, {\n        key: 0,\n        headers: _ctx.headers,\n        items: _ctx.filteredArticle,\n        \"fixed-header\": \"\",\n        height: \"400\",\n        onHandleCheckboxClick: _ctx.handleCheckboxClick\n      }, null, 8 /* PROPS */, [\"headers\", \"items\", \"onHandleCheckboxClick\"])) : _createCommentVNode(\"v-if\", true), _createVNode(_component_v_card, null, {\n        default: _withCtx(() => [_createVNode(_component_v_row, null, {\n          default: _withCtx(() => [_createVNode(_component_v_col, null, {\n            default: _withCtx(() => [_createVNode(_component_v_sheet, {\n              class: \"pl-2\"\n            }, {\n              default: _withCtx(() => [_createElementVNode(\"b\", null, _toDisplayString(_ctx.totalArticles), 1 /* TEXT */), _createTextVNode(\" articles \")]),\n              _: 1 /* STABLE */\n            })]),\n\n            _: 1 /* STABLE */\n          }), _createVNode(_component_v_col, null, {\n            default: _withCtx(() => [_createVNode(_component_v_sheet, null, {\n              default: _withCtx(() => [_createElementVNode(\"b\", null, _toDisplayString(_ctx.totalTransfert), 1 /* TEXT */), _createTextVNode(\" articles en attente Transfert \")]),\n              _: 1 /* STABLE */\n            })]),\n\n            _: 1 /* STABLE */\n          }), _createVNode(_component_v_col, null, {\n            default: _withCtx(() => [_createVNode(_component_v_sheet, null, {\n              default: _withCtx(() => [_createElementVNode(\"b\", null, _toDisplayString(_ctx.totalPorte), 1 /* TEXT */), _createTextVNode(\" articles en attente Porte \")]),\n              _: 1 /* STABLE */\n            })]),\n\n            _: 1 /* STABLE */\n          }), _createVNode(_component_v_col, null, {\n            default: _withCtx(() => [_createVNode(_component_v_sheet, null, {\n              default: _withCtx(() => [_createElementVNode(\"b\", null, _toDisplayString(_ctx.totalSansEmpl), 1 /* TEXT */), _createTextVNode(\" articles sans emplacement \")]),\n              _: 1 /* STABLE */\n            })]),\n\n            _: 1 /* STABLE */\n          })]),\n\n          _: 1 /* STABLE */\n        })]),\n\n        _: 1 /* STABLE */\n      })]),\n\n      _: 1 /* STABLE */\n    })])) : _createCommentVNode(\"v-if\", true)]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"titre_toolbar\", \"onClose\", \"modelValue\"]);\n}","map":{"version":3,"mappings":"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","names":["class","_createElementVNode","_createCommentVNode","_createBlock","_component_MyDialog","titre_toolbar","_ctx","onClose","_hoisted_1","_component_v_row","key","_createVNode","_component_v_col","cols","md","_component_v_list","lines","density","nav","_createElementBlock","_Fragment","depotCmd","item","i","_component_v_list_item","value","onClick","prepend","_component_v_icon","icon","_component_v_list_item_title","_toDisplayString","depot","_component_v_list_item_subtitle","nb_article","_component_v_table","height","_hoisted_2","rayon","_component_v_checkbox","etat","checked","color","onChange","_component_v_btn","block","rounded","variant","_hoisted_3","_component_v_alert","type","_component_ConfirmationDialog","title","message","onHandleYes","onHandleNo","_component_MyLoading","loading","articles","_component_router_view","_hoisted_4","_component_v_progress_linear","indeterminate","_component_v_container","fluid","_component_MyTable","headers","items","onHandleCheckboxClick","_component_v_card","_component_v_sheet"],"sourceRoot":"","sources":["/Users/anjaniainaandrianina/Desktop/Project/prepa/ERPO/frontend_prepa/prepa/src/views/PreparerCmd.vue"],"sourcesContent":["<template>\n    <MyDialog :titre_toolbar=titre_detail @close=\"closeDialog\" v-model=\"dialogVisible\">\n        <div class=\"pa-2\">\n            <v-row v-if=\"!loading\">\n                <v-col cols=\"10\" md=\"2\">\n                    <v-list :lines=\"false\" density=\"compact\" nav>\n                        <v-list-item v-for=\"(item, i) in storePrep.depotCmd\" :key=\"i\" :value=\"item\" active-color=\"primary\"\n                            @click=\"selectItem(item)\">\n                            <template v-slot:prepend>\n                                <v-icon icon=\"mdi-star\"></v-icon>\n                            </template>\n\n                            <v-list-item-title v-text=\"item.depot\"></v-list-item-title>\n                            <v-list-item-subtitle v-text=\"'Nb Article: ' + item.nb_article\"></v-list-item-subtitle>\n                        </v-list-item>\n                    </v-list>\n                </v-col>\n                <v-col cols=\"10\" md=\"2\">\n                    <v-table fixed-header height=\"300px\" density=\"compact\">\n                        <thead>\n                            <tr>\n                                <th class=\"text-center\" >\n                                    Rayon\n                                </th>\n                                <th class=\"text-center\" >\n                                    Nb Article\n                                </th>\n                                <th class=\"text-center\" >\n                                    <!-- <v-checkbox v-model=\"selectAll\" color=\"primary\" hide-details></v-checkbox> -->\n                                </th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr v-for=\"item in filteredRayonCmd \" :key=\"item.rayon\">\n                                <td>{{ item.rayon }}</td>\n                                <td>{{ item.nb_article }}</td>\n                                <td>\n                                    <v-checkbox v-model=\"item.etat\" v-bind:checked=\"item.etat\" hide-details color=\"primary\"\n                                        @change=\"handleCheckboxChange(item)\"></v-checkbox>\n                                </td>\n                            </tr>\n                        </tbody>\n                    </v-table>\n                </v-col>\n                <v-col cols=\"10\" md=\"4\">\n                </v-col>\n                <v-col cols=\"10\" md=\"2\" class=\"text-center\">\n                    <v-btn block rounded=\"xs\" variant=\"elevated\" color=\"#D3D3D3\" @click=\"onPrepareClick\">PREPARER</v-btn>\n                    <div class=\"pa-10\" v-if=\"selectedDepotCmd\">\n                        PREPARATION --> <b>{{ selectedDepotCmd.depot }}</b>\n                    </div>\n                    <v-alert v-if=\"isError\" type=\"error\" @click=\"isError = false, dialog = false\">preparation GROS en\n                        premier</v-alert>\n                    <v-alert v-if=\"isVide && !isError\" type=\"error\" @click=\"isVide = false, dialog = false\">La liste des\n                        articles à preparer est\n                        vide</v-alert>\n                    <v-alert v-if=\"isVideL6 && !isVide && !isError\" type=\"error\"\n                        @click=\"isVideL6 = false, dialog = false\">Un\n                        probleme est survenu sur la sortie de\n                        Bon de preparation, Veuillez contacter le responsable</v-alert>\n                    <ConfirmationDialog v-if=\"dialog && !isVideL6 && !isVide && !isError\" v-model=\"dialog\"\n                        title=\"Confirmation de Préparation\" :message=message @handleYes=\"handleYes\" @handleNo=\"handleNo\" />\n                    <MyLoading :loading=\"chagmt\" @close=\"chagmt = false\" :articles=\"articles\"></MyLoading>\n                    <router-view></router-view>\n\n                </v-col>\n\n            </v-row>\n        </div>\n        <div class=\"pa-2\">\n            <v-progress-linear v-if=\"loading\" color=\"primary\" rounded indeterminate height=\"5\">\n\n            </v-progress-linear>\n        </div>\n        <div v-if=\"updated\">\n            <v-container fluid>\n                <MyTable :headers=\"headers\" :items=\"filteredArticle\" fixed-header height=\"400\" v-if=\"!loading\"\n                    @handleCheckboxClick=\"handleCheckboxClick\">\n                </MyTable>\n\n                <v-card>\n                    <v-row>\n                        <v-col>\n                            <v-sheet class=\"pl-2\">\n                                <b> {{ totalArticles }}</b> articles\n                            </v-sheet>\n                        </v-col>\n\n                        <v-col>\n                            <v-sheet>\n                                <b> {{ totalTransfert }}</b> articles en attente Transfert\n                            </v-sheet>\n                        </v-col>\n\n                        <v-col>\n                            <v-sheet>\n                                <b> {{ totalPorte }}</b> articles en attente Porte\n                            </v-sheet>\n                        </v-col>\n\n                        <v-col>\n                            <v-sheet>\n                                <b> {{ totalSansEmpl }}</b> articles sans emplacement\n                            </v-sheet>\n                        </v-col>\n                    </v-row>\n                </v-card>\n\n            </v-container>\n\n        </div>\n    </MyDialog>\n</template>\n\n<script>\nimport MyDialog from '@/components/DialogFullScreen.vue';\nimport MyTable from '@/components/MyTable.vue';\nimport MyList from '@/components/MyList.vue';\nimport MyTextarea from '@/components/MyTextarea.vue';\nimport MyTextField from '@/components/MyTextField.vue';\nimport MySelect from '@/components/MySelect.vue';\nimport Alert from '@/components/Alert.vue';\nimport ConfirmationDialog from '@/components/ConfirmationDialog.vue';\nimport { prepCommandStore } from \"@/store/Apreparer/genererPrep\";\nimport { useCreateBP } from \"@/store/Apreparer/creationBP\";\nimport { VDataTable } from 'vuetify/labs/VDataTable';\nimport { useRoute, useRouter } from 'vue-router';\nimport MyLoading from '@/components/Loading.vue';\nimport { useReportBPStore } from \"@/store/report/printBP\";\nimport { ref, reactive, onMounted, computed, defineEmits, defineComponent, watch, onBeforeMount, onUpdated } from \"vue\";\nexport default defineComponent({\n    components: {\n        MyDialog,\n        MyTable,\n        MyList,\n        MyTextarea,\n        MyTextField,\n        MySelect,\n        Alert,\n        ConfirmationDialog,\n        MyLoading,\n    },\n    name: 'preparerCmd',\n    setup() {\n        const showDialog = ref(false);\n        const route = useRoute();\n        const CC = route.params.CC;\n        const router = useRouter();\n        const storePrep = prepCommandStore();\n        const storeCreBP = useCreateBP();\n        const loading = computed(() => storePrep.loading)\n        const updated = ref(false);\n        const chagmt = ref(false);\n        const articles = ref(null);\n        const selectEtat = ref(null);\n        const rayonEtat = ref(null);\n        const isError = ref(false);\n        const isVide = ref(false);\n        const isVideL6 = ref(false);\n        const selectedDepotCmd = ref(null);\n        const dialog = ref(false);\n        let message = ref(\"\");\n        const storePrintBP = useReportBPStore();\n\n\n\n\n        const dialogVisible = ref(false);\n\n        let titre_detail = ref(\"\");\n\n\n        function closeDialog() {\n            dialogVisible.value = false;\n            history.back();\n           // router.push({ name: 'attePrepa' });\n        }\n\n        const headersRayonCmd = [\n            { text: 'Rayon', align: 'start', value: 'rayon', sortable: true },\n            { text: 'Nb Article', align: 'start', value: 'nb_article' },\n            { text: 'Select', value: 'etat' },\n\n        ]\n\n\n        const headers = [\n            { title: 'commande', align: 'start', key: 'code_CCL' },\n            { title: 'Article', align: 'center', key: 'article', sortable: true },\n            { title: 'Libellé', align: 'start', key: 'libelle' },\n            { title: 'Quantité en Prep', align: 'center', key: 'qte_a_preparer' },\n            { title: 'Quantité Dispo', align: 'center', key: 'dispo' },\n            { title: 'Transfert', align: 'center', key: 'transfert' },\n            { title: 'etat', align: 'center', key: 'etat' },\n        ]\n\n\n        onBeforeMount(() => {\n            dialogVisible.value = true;\n            titre_detail.value = \"Preparation du Commande \" + CC;\n            fetchPrepa();\n        })\n\n        const fetchPrepa = async () => {\n            storePrep.params.code = CC;\n            await storePrep.fetchPreparerCmd();\n            if (storePrep.depotCmd.length > 0) {\n                selectedDepotCmd.value = storePrep.depotCmd[0];\n            }\n            filteredListeComp();\n        }\n\n        const selectItem = (item) => {\n            selectedDepotCmd.value = item;\n            reactiveEtat();\n            filteredListeComp();\n        };\n\n        const reactiveEtat = () => {\n            storePrep.rayonCmd.forEach(item => {\n                item.etat = true;\n            });\n            storePrep.articleCmd.forEach(item => {\n                if (item.transfert !== 'Transfert' && item.transfert !== 'Sans Empl' && item.transfert !== 'Porte') {\n                    item.etat = true;\n                }\n            });\n\n        }\n\n\n        const totalArticles = computed(() => {\n            return filteredArticle.value.length;\n        });\n\n        const totalTransfert = computed(() => {\n            return filteredArticle.value.filter(item => item.transfert === \"Transfert\").length\n        });\n\n        const total_T = computed(() => {\n            return filteredListeCmd.value.filter(item => (item.transfert === \"Transfert\" || item.transfert === \"Porte\" || item.transfert === \"Sans Empl\")).length\n        });\n        const totalPorte = computed(() => {\n            return filteredArticle.value.filter(item => item.transfert === \"Porte\").length\n        });\n\n        const totalSansEmpl = computed(() => {\n            return filteredArticle.value.filter(item => item.transfert === \"Sans Empl\").length\n        });\n\n        const depotDefaut = computed(() => {\n            if (!selectedDepotCmd.value && storePrep.depotCmd.length > 0) {\n                selectedDepotCmd.value = storePrep.depotCmd[0];\n            }\n            return selectedDepotCmd.value.depot\n        })\n\n\n        const filteredArticle = computed(() => {\n            if (selectedDepotCmd.value && !rayonEtat.value) {\n                return storePrep.articleCmd.filter(item => (item.depot.trim() === selectedDepotCmd.value.depot.trim()\n\n                ));\n\n            } else if (rayonEtat.value) {\n                return storePrep.articleCmd.filter(item => (item.depot.trim() === selectedDepotCmd.value.depot.trim()\n                    &&\n                    filteredListeCmd.value.some(list => list.article.trim() === item.article.trim() && list.depot.trim() === item.depot.trim())\n                ));\n            }\n            else {\n                return storePrep.articleCmd;\n            }\n        });\n\n        const filteredRayonCmd = computed(() => {\n            if (selectedDepotCmd.value && storePrep.depotCmd.length > 0) {\n                return storePrep.rayonCmd.filter(item => item.depot.trim() === selectedDepotCmd.value.depot.trim());\n            } else {\n                return storePrep.rayonCmd;\n            }\n        });\n\n        const filteredListeCmd = computed(() => {\n            if (selectedDepotCmd.value && !rayonEtat.value) {\n                return storePrep.listeCmd.filter(item => (item.depot.trim() === selectedDepotCmd.value.depot.trim()\n                ));\n            } else if (rayonEtat.value) {\n                return storePrep.listeCmd.filter(item => (item.depot.trim() === selectedDepotCmd.value.depot.trim() &&\n                    filteredRayonCmd.value.some(rayon => rayon.rayon.trim() === item.rayon.trim() && rayon.etat === true)\n                ));\n            }\n            else {\n                return storePrep.listeCmd;\n            }\n\n        });\n\n\n        const handleCheckboxClick = (item) => {\n            selectEtat.value = item;\n            filteredListeCmdEtat();\n        }\n\n\n\n        const filteredListeCmdEtat = () => {\n            let updatedListeCmd = filteredListeCmd.value.map(item => {\n                if (item.article.trim() === selectEtat.value.value.article.trim()) {\n                    item.etat = !selectEtat.value.value.etat;\n                }\n                return item;\n            });\n            filteredListeCmd.value = updatedListeCmd;\n        };\n\n\n        const filteredListeComp = () => {\n            filteredListeCmd.value.forEach(itemA => {\n                const itemB = filteredArticle.value.find(itemB => (itemB.article.trim() === itemA.article.trim() && itemB.depot.trim() === itemA.depot.trim()))\n                if (itemB) {\n                    itemA.etat = itemB.etat\n                }\n\n            })\n            updated.value = true;\n\n        };\n\n        const handleCheckboxChange = (item) => {\n            rayonEtat.value = item;\n        };\n\n        const isPrioGros = () => {\n            const itemB = storePrep.depotCmd.find(itemB => (itemB.depot.trim() === 'GROS'));\n            if (selectedDepotCmd.value && itemB) {\n                if (selectedDepotCmd.value.depot.trim() !== itemB.depot) {\n                    return false;\n                } else {\n                    return true;\n                }\n            } else {\n                return true;\n            }\n        };\n\n        const onPrepareClick = async () => {\n            const isGros = isPrioGros();\n            if (!selectedDepotCmd.value) {\n                selectedDepotCmd.value = storePrep.depotCmd[0];\n            }\n            message.value = \"Voulez vous préparer ces articles côchés dans le dépôt \" + selectedDepotCmd.value.depot;\n            if (isGros) {\n                isError.value = false;\n                dialog.value = true;\n            } else {\n                isError.value = true;\n                dialog.value = false;\n\n            }\n            if ((filteredArticle.value.filter(item => item.etat === true).length) > 0) {\n                isVide.value = false;\n                dialog.value = true;\n            } else {\n                isVide.value = true;\n                dialog.value = false;\n            }\n            if ((filteredListeCmd.value.filter(item => item.etat === true).length) > 0) {\n                isVideL6.value = false;\n                dialog.value = true;\n            } else {\n                isVideL6.value = true;\n                dialog.value = false;\n            }\n\n\n\n        };\n        function handleYes() {\n            dialog.value = false;\n            fetchInsertBP();\n        }\n\n        function handleNo() {\n            dialog.value = false;\n        }\n\n        const atteTransfert = async () => {\n            if (total_T.value > 0) {\n                for (let i = 0; i < filteredListeCmd.value.length; i++) {\n                    const item = filteredListeCmd.value[i];\n                    if (item.transfert === \"Transfert\" || item.transfert === \"Porte\" || item.transfert === \"Sans Empl\") {\n                        const params = {\n                            code_CC: item.lienCode,\n                            xSeq: item.BPLSEQ,\n                        }\n                        await storeCreBP.atteTransfert(params);\n                    }\n                }\n\n            }\n\n        }\n\n        const fetchInsertBP = async () => {\n            chagmt.value = true;\n            await storeCreBP.getId();\n            for (let i = 0; i < filteredListeCmd.value.length; i++) {\n                const item = filteredListeCmd.value[i];\n                if (item.etat === true) {\n                    item.myID = storeCreBP.myId;\n                    let j = i + 1;\n                    articles.value = item.article + \"[\" + j + \"/\" + filteredListeCmd.value.length + \"]\";\n                    const { article, lettre, designation, lienCode, lienNum, Qte, unitfact, prix_ht, modeliv, lignelibre, typeVente, reglement, echeancesp, abs_qte, factman, offert, artype, devise, coursdev, prixht_dev, totht_dev, rem1, rem2, rem3, totPrix_HT, emplacement, attachement, lot, arreffour, cclmarche, ccldate, cclcolis, arqtecolis, cclpaht, seqLib, comment_mag, cclcolisage, cclnbcolis, cclpack, rayon, depot, cclpromo, myID } = item;\n                    await storeCreBP.insertL6(item);\n                }\n            };\n            const params = {\n                ids: storeCreBP.myId,\n                code_CC: CC,\n                depot: depotDefaut.value\n            }\n            await storeCreBP.insertBP(params);\n\n            if (storeCreBP.code_BP !== '' && storeCreBP.code_BP !== null) {\n                await atteTransfert();\n                articles.value = \"Impression \" + storeCreBP.code_BP;\n                try {\n                    const response = await storePrintBP.generateReport(storeCreBP.code_BP, 0);\n                    const blob = new Blob([response.data], { type: 'application/pdf' });\n                    const url = URL.createObjectURL(blob);\n                    window.open(url, '_blank');\n                    URL.revokeObjectURL(url);\n                } catch (error) {\n                    console.error(error);\n                }\n                chagmt.value = false;\n                await fetchPrepa();\n                if (storePrep.depotCmd.length === 0) {\n                    closeDialog();\n                    console.log(\"La liste storePrep.depotCmd est vide.\");\n                }\n            }\n\n        }\n\n\n\n\n\n        return {\n            dialogVisible, titre_detail, closeDialog, CC, headersRayonCmd, storePrep, fetchPrepa, selectItem, headers, loading, filteredRayonCmd, filteredArticle,\n            selectedDepotCmd, handleCheckboxClick, filteredListeCmd, filteredListeComp, updated, handleCheckboxChange, totalArticles, totalTransfert,\n            totalPorte, totalSansEmpl, onPrepareClick, isPrioGros, isError, isVide, isVideL6, dialog, showDialog, message, handleYes, handleNo, fetchInsertBP, storeCreBP,\n            chagmt, articles, atteTransfert\n\n\n        }\n    },\n});\n</script>\n\n<style scoped>\n/* .container {\n    display: flex;\n    flex-direction: row;\n\n    justify-content: space-between;\n    max-height: 500px;\n    overflow-y: auto;\n}\n\n.left {\n    flex-basis: 70%;\n}\n\n.right {\n    flex-basis: 30%;\n} */\n\n.v-list-item.active {\n    background-color: blue;\n    color: white;\n}\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}